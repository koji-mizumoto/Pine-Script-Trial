//@version=5
indicator("Scaled Center Price with Linear Regression", overlay=true)

// 入力設定
length = input.int(20, title="Length for Center Price")
scaleFactor = input.float(1.0, title="Scale Factor")  // スケーリングファクター
regressionLength = input.int(14, title="Length for Linear Regression")  // 線形回帰の期間

// 中心価格の計算（中央値）
centerPrice = ta.median(close, length)

// 中心価格のスケーリング
scaledCenterPrice = centerPrice * scaleFactor

// 線形回帰の計算
linearReg = ta.linreg(scaledCenterPrice, regressionLength, 0)

// 中心価格とスケーリングされた価格をプロット
plot(centerPrice, color=color.blue, title="Center Price (Median)", linewidth=2)
plot(scaledCenterPrice, color=color.orange, title="Scaled Center Price", linewidth=2)
plot(linearReg, color=color.green, title="Linear Regression", linewidth=2)

// 0ラインを描画
hline(0, color=color.gray, linestyle=hline.style_dotted, linewidth=1)